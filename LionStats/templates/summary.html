<!DOCTYPE html>
{% extends 'navbar.html' %}
{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    {% block css %}
    <link rel="stylesheet" type="text/css" href="{% static 'styles/summary.css' %}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.js"></script>
    <script src="{% static 'js/dropdownSummary.js' %}"></script>
    {% endblock %}

    {% block title %}
    <title>Summary</title>
    {% endblock %}
</head>

<body>
{% block content %}

<div class ="chart">
    <button type="button" id = "chartBtn" onclick="chart()">Load Chart</button>
    <canvas id ="teamChart" width="800px" height="500px"></canvas>
</div>


<script>
{% block jquery %}
function chart(){
var endpoint = '/api/sumData'
var teamData = []
var labels = []
$.ajax({
    method: "GET",
    url: endpoint,
    success: function(data){
        teamData = data.default
        console.log(teamData);
        var ctx = document.getElementById('teamChart').getContext('2d');
        var teamChart = new Chart(ctx, {
          type: 'bar',
          data:{
          labels: labels,
          datasets: [{
            label: 'Duration',
            data: [teamData[0]],
            backgroundColor: "Red",
            borderWidth: 1
          }, {
            label: 'eTrimp',
            data: [teamData[1]],
            backgroundColor: "Orange",
            borderWidth: 1
          }, {
            label: 'sTrimp',
            data: [teamData[2]],
            backgroundColor: "Yellow",
            borderWidth: 1
          }, {
            label: 'EXP',
            data: [teamData[3]],
            backgroundColor: "Green",
            borderWidth: 1
          }, {
            label: 'HR90',
            data: [teamData[4]],
            backgroundColor: "Blue",
            borderWidth: 1
          }, {
            label: 'DIST',
            data: [teamData[5]],
            backgroundColor: "Purple",
            borderWidth: 1
          }, {
            label: 'HSR',
            data: [teamData[6]],
            backgroundColor: "Indigo",
            borderWidth: 1
          }, {
            label: 'SPNT',
            data: [teamData[7]],
            backgroundColor: "Pink",
            borderWidth: 1
          }, {
            label: 'HSR/SP',
            data: [teamData[8]],
            backgroundColor: "LightBlue",
            borderWidth: 1
          }, {
            label: 'rEXP',
            data: [teamData[9]],
            backgroundColor: "DarkRed",
            borderWidth: 1
          }, {
            label: 'rDIST',
            data: [teamData[10]],
            backgroundColor: "DarkOrange",
            borderWidth: 1
          }, {
            label: 'rHSR',
            data: [teamData[11]],
            backgroundColor: "Aquamarine",
            borderWidth: 1
          }, {
            label: 'rSPNT',
            data: [teamData[12]],
            backgroundColor: "DarkOrchid",
            borderWidth: 1
          }]
          },
           options: {
                legend: {
                    display: true,
                    position: 'bottom'
                }
            }
        });

        },
    error: function(error_data){
        console.log("error")
        console.log(error_data)
    }
})
}
{% endblock %}
</script>

<div class="Summarycontent">

<!--    <div class="Position">-->
<!--        <h4> Position </h4>-->
<!--        <div class="Dropdown">-->
<!--            <nav>-->
<!--                <select name = "summaryPosition" class="menu" id = "dropdownPosition" onchange="val()">-->
<!--                </select>-->
<!--            </nav>-->
<!--        </div>-->
<!--    </div>-->

    <h1 class="start">Start Date</h1>
    <div class="date-start">
        <input type="date" id="myStartDate" onchange="startDateTeam()">

            <script>
                function startDateTeam()
                    {
                        var selected = $('#myStartDate').val();
                        console.log(selected);
                        let csrftoken = '{{ csrf_token }}';
                        $.ajax({
                        url:'/startdate/',
                        type: "POST",
                        headers:{'X-CSRFToken': csrftoken},
                        data: {'value' : selected,},
                        dataType: "json",
                        });
                    }
            </script>
    </div>

    <h1 class="finish">Finish Date</h1>
    <div class="date-finish">
        <input type="date" id="myEndDate" onchange="endDateTeam()">

            <script>
                function endDateTeam()
                    {
                        var selected = $('#myEndDate').val();
                        console.log(selected);
                        let csrftoken = '{{ csrf_token }}';
                        $.ajax({
                        url:'/enddate/',
                        type: "POST",
                        headers:{'X-CSRFToken': csrftoken},
                        data: {'value' : selected,},
                        dataType: "json",
                        });
                    }
            </script>
    </div>

    <h1 class="session"> Session Team Average </h1>

</div>
<!-- Average of all of the metrics for the entire time over the specified date range-->
{% endblock %}

{% block topbar %}
<span class="TopBar">Summary</span>
{% endblock %}
</body>
</html>